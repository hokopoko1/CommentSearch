<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.smh.cs.dao.SearchDao">
	<insert id="addVideoInfo" parameterType="com.smh.cs.model.VideoInfo">
		INSERT IGNORE INTO
			video_info(
				video_id,
				title,
				video_time,
				thumbnail,
				type,
				description,
				view_count,
				comment_count,
				title_length,
				description_length
			)
		VALUES
			(
				#{videoId},
				#{title},
				#{videoTime},
				#{thumbnail},
				#{type},
				#{description},
				#{viewCount},
				#{commentCount},
				#{titleLength},
				#{descriptionLength}
			)
	</insert>
	
	<insert id="addCommentInfo" parameterType="com.smh.cs.model.CommentInfo">
		INSERT IGNORE INTO
			comment(
				video_id,
				author,
				time,
				comment,
				comment_length,
				chat,
				chat_length,
				sentiment,
				magnitude
			)
		VALUES
			(
				#{videoId},
				#{author},
				#{time},
				#{comment},
				#{commentLength},
				#{chat},
				#{chatLength},
				#{sentiment},
				#{magnitude}
				
			)
	</insert>
	                   
	<select id="selectVideoInfo" resultType="videoInfo">
		SELECT 
			id, 
			video_id As videoId, 
			title,
			video_time As videoTime,
			thumbnail,
			type,
			description,
			view_count AS viewCount,
			comment_count AS commentCount,
			title_length AS titleLength,
			description_length AS descriptionLength
		
		FROM video_info
	</select>

	<select id="selectCommentInfo" parameterType="com.smh.cs.model.CommentInfo" resultType="com.smh.cs.model.CommentInfo">
		SELECT id, 
			video_id As videoId,
			author,
			time,
			comment,
			comment_length AS commentLength,
			sentiment, 
			magnitude, 
			chat,
			chat_length AS chatLength,
			senti_update AS sentiUpdate
		FROM comment
		WHERE video_id = #{videoId}
		<if test="limit != 0">
    		LIMIT #{limit}
		</if>
	</select>
              
	<update id="updateSentiment" parameterType="com.smh.cs.model.CommentInfo">
		UPDATE comment SET
			sentiment = #{sentiment},
			magnitude = #{magnitude},
			senti_update = 'true'
		WHERE
			id = #{id}
	</update>

</mapper>